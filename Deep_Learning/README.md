# Deep Learning – NBA Lineup Impact Prediction

This directory contains all the files related to the deep learning component of the CISC 352 AI project. The goal of this module is to use a neural network to predict the performance of NBA lineups based on player combinations and game context, using data from the 2021–22 season.

## 🧠 Overview

- A feedforward neural network is trained to predict **impact per 36 minutes** for each 5-man lineup.
- Predictions are **adjusted** based on total minutes played to account for lineup reliability.
- Final output includes:
  - Top 3 and bottom 3 **starting lineups** per team (with at least 3 starts)
  - Top 3 **non-starting lineups** per team that have played at least 5 games

## 📁 File Descriptions

| File | Description |
|------|-------------|
| `DL_prediction.py` | Main deep learning script. Trains the model, makes predictions, and generates `lineup_predictions.txt`. |
| `lineup_performance.csv` | Input dataset with cleaned and enriched lineup data (parsed from raw season data) for how each lineup performed each time they were on the court. |
| `from_sorted_filtered_to_lineups.py` | Preprocessing script that constructs `lineup_performance.csv` by aggregating lineup events from play-by-play data. |
| `filter_to_2021-22.py` | Filters raw `all_games.csv` down to only the 2021–22 season and saves it as `sorted_filtered_2021_22_season.csv`. |
| `all_games.csv` | Full NBA game data (multiple seasons). Not used directly — filtered down to 2021–22. |
| `sorted_filtered_2021_22_season.csv` | Output from filtering script, containing play-by-play events for only the 2021–22 season. |
| `lineup_predictions.txt` | Main output file listing the best/worst/alternative lineups per team. Generated by `DL_prediction.py`. |
| `my_predictions.txt` | The output instance that is used in the report, kept separate because the model will not give the exact same results each time. |
| `.zip` files | Compressed versions of large `.csv` files to meet GitHub size limits. |

## 📚 Data Source

The raw data used for this project (`all_games.csv`) was obtained from the following public Kaggle dataset:

**NBA Play-by-Play Data**  
🔗 https://www.kaggle.com/datasets/xocelyk/nba-pbp

The dataset includes event-level play-by-play logs across multiple NBA seasons. For this project, only the 2021–22 season was used after preprocessing with `filter_to_2021-22.py`.


## 🚀 How to Run

1. Make sure you have Python 3.7+ and PyTorch installed.
    -> pip install torch
2. Run the main script:

```bash
python DL_prediction.py
